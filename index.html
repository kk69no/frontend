<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>P2P Circles Tracker - Full Version</title>
  <style>
    /* --- –°—Ç–∏–ª–∏ --- */
    :root {
      --bg: #f6f8fa;
      --card: #fff;
      --pri: #4f46e5;
      --pri-dark: #4338ca;
      --succ: #16a34a;
      --warn: #f59e0b;
      --danger: #dc2626;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: "Inter", Arial, sans-serif;
      background: var(--bg);
      padding: 1rem;
      color: #111827;
      min-height: 100vh;
    }
    h1, h2, h3 {
      color: var(--pri);
      margin-bottom: 1rem;
    }
    .wrap {
      max-width: 900px;
      margin: auto;
      background: var(--card);
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,.05);
    }
    label {
      display: block;
      margin-top: 1rem;
      margin-bottom: .3rem;
      font-weight: 600;
      color: #374151;
    }
    input, select, button, textarea {
      width: 100%;
      padding: .75rem 1rem;
      border-radius: 10px;
      font-size: 1rem;
      border: 1.7px solid #d1d5db;
      font-family: inherit;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--pri);
      box-shadow: 0 0 0 3px rgb(79 70 229 / 0.25);
    }
    button {
      border: none;
      background: var(--pri);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      margin-top: 1rem;
      transition: .2s;
    }
    button:hover {
      background: var(--pri-dark);
    }
    .flex {
      display: flex;
      gap: .5rem;
      margin-top: .5rem;
    }
    .flex > button {
      flex: 1;
    }
    .pill {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 8px;
      font-size: .75rem;
      color: #fff;
      margin-left: .25rem;
    }
    .pill.open {
      background: var(--warn);
    }
    .pill.closed {
      background: var(--succ);
    }
    .pill.error {
      background: var(--danger);
    }
    progress {
      width: 100%;
      height: 14px;
      border: none;
      border-radius: 7px;
      overflow: hidden;
      margin-top: 0.5rem;
      margin-bottom: 0.5rem;
    }
    progress::-webkit-progress-bar {
      background: #e5e7eb;
    }
    progress::-webkit-progress-value {
      background: var(--pri);
    }
    ul {
      margin: .4rem 0 0 1rem;
      color: #374151;
      font-size: .9rem;
      max-height: 140px;
      overflow-y: auto;
      padding-left: 1rem;
    }
    ul li {
      margin-bottom: 0.25rem;
    }
    .card {
      margin-bottom: 1.5rem;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 1rem;
      background: #fff;
    }
    .delete-btn {
      background: var(--danger);
      margin-top: 1rem;
      width: auto;
      padding: 0.5rem 1rem;
    }
    .analytics-block {
      background: #fafafa;
      border: 1px solid #ddd;
      padding: 1rem;
      border-radius: 10px;
      margin-top: 2rem;
    }
    textarea {
      resize: vertical;
      min-height: 60px;
    }
    .error-msg {
      color: var(--danger);
      font-weight: 600;
      margin-top: 0.5rem;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>P2P Circles Tracker - –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è</h1>

    <!-- –í—ã–±–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—Ä—É–≥–∞ -->
    <label for="circleSelect">–ê–∫—Ç–∏–≤–Ω—ã–π –∫—Ä—É–≥ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏</label>
    <select id="circleSelect" aria-label="–í—ã–±–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—Ä—É–≥–∞"></select>

    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏ -->
    <label for="type">–¢–∏–ø —Å–¥–µ–ª–∫–∏</label>
    <select id="type" aria-label="–¢–∏–ø —Å–¥–µ–ª–∫–∏">
      <option value="buy">–ü–æ–∫—É–ø–∫–∞ ‚Äî –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–π –∫—Ä—É–≥</option>
      <option value="sell">–ü—Ä–æ–¥–∞–∂–∞</option>
    </select>

    <label for="amount">–°—É–º–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ (‚ÇΩ)</label>
    <input id="amount" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤ —Ä—É–±–ª—è—Ö" min="0" step="any" aria-label="–°—É–º–º–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ä—É–±–ª—è—Ö"/>

    <div class="flex">
      <button type="button" data-add="1">+1</button>
      <button type="button" data-add="10">+10</button>
      <button type="button" data-add="100">+100</button>
    </div>

    <label for="currency">–í–∞–ª—é—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, USDT)</label>
    <input id="currency" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞–ª—é—Ç—É" aria-label="–í–∞–ª—é—Ç–∞ —Å–¥–µ–ª–∫–∏" />

    <label for="price">–¶–µ–Ω–∞ –∑–∞ 1 –µ–¥. (‚ÇΩ)</label>
    <input id="price" type="number" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É" min="0" step="any" aria-label="–¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É" />

    <label for="note">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ (–±–∏—Ä–∂–∞, –ø–ª–∞—Ç—ë–∂–∫–∞ –∏ —Ç.–¥.)</label>
    <textarea id="note" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ" aria-label="–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –∫ —Å–¥–µ–ª–∫–µ"></textarea>

    <button id="addDeal" type="button">–î–æ–±–∞–≤–∏—Ç—å —Å–¥–µ–ª–∫—É</button>
    <button id="export" type="button">üì§ –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</button>

    <!-- –û—à–∏–±–∫–∏ -->
    <div id="errorMsg" class="error-msg" role="alert" aria-live="assertive"></div>

    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –∫—Ä—É–≥–æ–≤ -->
    <div id="circles" style="margin-top: 2rem;"></div>

    <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
    <div id="analytics" class="analytics-block" aria-live="polite"></div>
  </div>

<script>
(() => {
  'use strict';

  // --- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã ---
  const STORAGE_KEY = 'p2p_circles_full_v1';
  const circles = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  const $ = id => document.getElementById(id);
  const nf = n => Number(n) || 0;
  const fmt = n => Number(n).toFixed(2);

  // –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö ID (UUID v4 —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π)
  function generateId() {
    return 'xxxx-xxxx-xxxx-xxxx'.replace(/[x]/g, () => (Math.floor(Math.random() * 16)).toString(16));
  }

  // --- –†–∞–±–æ—Ç–∞ —Å –æ—à–∏–±–∫–∞–º–∏ ---
  function showError(msg) {
    const el = $('errorMsg');
    el.textContent = msg;
    if(msg) {
      setTimeout(() => { el.textContent = ''; }, 4000);
    }
  }

  // --- –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage ---
  function saveData() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(circles));
  }

  // --- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—Ä—É–≥–æ–≤ ---
  function refreshSelect() {
    const sel = $('circleSelect');
    sel.innerHTML = '';

    const openCircles = circles.filter(c => !c.closed);

    if (openCircles.length === 0) {
      sel.disabled = true;
      return;
    }

    sel.disabled = false;
    openCircles.forEach(c => {
      const opt = document.createElement('option');
      opt.value = c.id;
      opt.textContent = `#${c.id} ‚Ä¢ –û—Å—Ç–∞—Ç–æ–∫: ${fmt(c.remainingQty)} ${c.currency}`;
      sel.appendChild(opt);
    });

    // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π id –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å—Ç–∞–≤–∏–º –ø–µ—Ä–≤—ã–π
    if (!Array.from(sel.options).some(opt => opt.value === sel.value)) {
      sel.value = openCircles[0].id;
    }
  }

  // --- –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –∫—Ä—É–≥–∞ –ø–æ ID ---
  function findCircleById(id) {
    return circles.find(c => c.id === id);
  }

  // --- –†–∞—Å—Å—á—ë—Ç –ø—Ä–æ—Ñ–∏—Ç–∞ –∏ —Å–ø—Ä–µ–¥–∞ –¥–ª—è –∫—Ä—É–≥–∞ ---
  function calculateCircleStats(c) {
    // –°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü (–∫–æ–ª-–≤–æ * —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏)
    const costOfSold = c.sellQty * c.buyPrice;
    // –ü—Ä–æ—Ñ–∏—Ç ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –≤—ã—Ä—É—á–∫–æ–π –æ—Ç –ø—Ä–æ–¥–∞–∂ –∏ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å—é
    const profit = c.sellRub - costOfSold;
    // –°–ø—Ä–µ–¥ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    const spread = costOfSold ? ((c.sellRub / costOfSold - 1) * 100) : 0;

    return { profit, spread, costOfSold };
  }

  // --- –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤—Å–µ—Ö –∫—Ä—É–≥–æ–≤ ---
  function renderCircles() {
    const wrap = $('circles');
    wrap.innerHTML = '';

    circles.forEach(c => {
      const { profit, spread } = calculateCircleStats(c);
      const card = document.createElement('div');
      card.className = 'card';

      card.innerHTML = `
        <strong>–ö—Ä—É–≥ #${c.id}</strong> 
        <span class="pill ${c.closed ? 'closed' : 'open'}">${c.closed ? '–ó–∞–∫—Ä—ã—Ç' : '–û—Ç–∫—Ä—ã—Ç'}</span><br>
        <b>–í–∞–ª—é—Ç–∞:</b> ${c.currency}<br>
        <b>–ö—É–ø–ª–µ–Ω–æ:</b> ${fmt(c.buyQty)} @ ${fmt(c.buyPrice)} ‚ÇΩ (–ò—Ç–æ–≥–æ: ${fmt(c.buyRub)} ‚ÇΩ)<br>
        <b>–ü—Ä–æ–¥–∞–Ω–æ:</b> ${fmt(c.sellQty)} (–í—ã—Ä—É—á–∫–∞: ${fmt(c.sellRub)} ‚ÇΩ)<br>
        <b>–û—Å—Ç–∞—Ç–æ–∫:</b> ${fmt(c.remainingQty)} ${c.currency}<br>
        <b>–ü—Ä–æ—Ñ–∏—Ç:</b> ${fmt(profit)} ‚ÇΩ<br>
        <b>–°–ø—Ä–µ–¥:</b> ${fmt(spread)} %<br>
        <progress value="${c.sellRub}" max="${c.buyRub}"></progress>

        <h3>–ü—Ä–æ–¥–∞–∂–∏:</h3>
        <ul>
          ${c.sells.length ? c.sells.map(s =>
            `<li>${fmt(s.qty)} ${c.currency} @ ${fmt(s.price)} ‚ÇΩ (${fmt(s.rub)} ‚ÇΩ) ‚Äî ${s.note || '–±–µ–∑ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è'}</li>`
          ).join('') : '<li>–ü—Ä–æ–¥–∞–∂ –ø–æ–∫–∞ –Ω–µ—Ç</li>'}
        </ul>
      `;

      // –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–∫—Ä—ã—Ç—ã—Ö –∫—Ä—É–≥–æ–≤
      if (c.closed) {
        const btnDel = document.createElement('button');
        btnDel.className = 'delete-btn';
        btnDel.textContent = '–£–¥–∞–ª–∏—Ç—å –∫—Ä—É–≥';
        btnDel.onclick = () => {
          if (confirm(`–£–¥–∞–ª–∏—Ç—å –∫—Ä—É–≥ #${c.id}? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.`)) {
            const idx = circles.findIndex(x => x.id === c.id);
            if (idx !== -1) {
              circles.splice(idx, 1);
              saveData();
              render();
            }
          }
        };
        card.appendChild(btnDel);
      }

      wrap.appendChild(card);
    });
  }

  // --- –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ –≤—Å–µ–º –∫—Ä—É–≥–∞–º ---
  function renderAnalytics() {
    const analytics = $('analytics');

    if (circles.length === 0) {
      analytics.innerHTML = '<h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2><p>–ö—Ä—É–≥–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>';
      return;
    }

    const totalBuyRub = circles.reduce((acc, c) => acc + c.buyRub, 0);
    const totalSellRub = circles.reduce((acc, c) => acc + c.sellRub, 0);
    const totalProfit = totalSellRub - circles.reduce((acc, c) => acc + (c.sellQty * c.buyPrice), 0);
    const openCount = circles.filter(c => !c.closed).length;
    const closedCount = circles.length - openCount;

    analytics.innerHTML = `
      <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
      <p>–í—Å–µ–≥–æ –∫—Ä—É–≥–æ–≤: <strong>${circles.length}</strong></p>
      <p>–û—Ç–∫—Ä—ã—Ç—ã—Ö: <strong>${openCount}</strong>, –ó–∞–∫—Ä—ã—Ç—ã—Ö: <strong>${closedCount}</strong></p>
      <p>–û–±—â–∞—è —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫: <strong>${fmt(totalBuyRub)} ‚ÇΩ</strong></p>
      <p>–û–±—â–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂: <strong>${fmt(totalSellRub)} ‚ÇΩ</strong></p>
      <p>–û–±—â–∏–π –ø—Ä–æ—Ñ–∏—Ç: <strong>${fmt(totalProfit)} ‚ÇΩ</strong></p>
    `;
  }

  // --- –û–±—â–∏–π —Ä–µ–Ω–¥–µ—Ä ---
  function render() {
    refreshSelect();
    renderCircles();
    renderAnalytics();
  }

  // --- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ ---
  $('addDeal').onclick = () => {
    const type = $('type').value;
    const rub = nf($('amount').value);
    const cur = $('currency').value.trim().toUpperCase();
    const price = nf($('price').value);
    const note = $('note').value.trim();

    // –ü—Ä–æ–≤–µ—Ä–∫–∏
    if (!rub || !price || !cur) {
      showError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: —Å—É–º–º–∞, –≤–∞–ª—é—Ç–∞, —Ü–µ–Ω–∞.');
      return;
    }
    if (type === 'buy') {
      // –ù–æ–≤—ã–π –∫—Ä—É–≥
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ—Ç –ª–∏ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∫—Ä—É–≥–∞ —Å —Ç–∞–∫–æ–π –∂–µ –≤–∞–ª—é—Ç–æ–π (–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ª–æ–≥–∏–∫—É, –µ—Å–ª–∏ –Ω–∞–¥–æ)
      const newId = generateId();
      const qty = rub / price;
      circles.push({
        id: newId,
        currency: cur,
        buyRub: rub,
        buyPrice: price,
        buyQty: qty,
        remainingQty: qty,
        sellQty: 0,
        sellRub: 0,
        sells: [],
        closed: false
      });
      showError('');
    } else if (type === 'sell') {
      // –ü—Ä–æ–¥–∞–∂–∞
      if ($('circleSelect').disabled) {
        showError('–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—Ä—É–≥–æ–≤ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏.');
        return;
      }
      const selectedId = $('circleSelect').value;
      const c = findCircleById(selectedId);
      if (!c) {
        showError('–í—ã–±—Ä–∞–Ω–Ω—ã–π –∫—Ä—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω.');
        return;
      }
      if (c.closed) {
        showError('–í—ã–±—Ä–∞–Ω–Ω—ã–π –∫—Ä—É–≥ —É–∂–µ –∑–∞–∫—Ä—ã—Ç.');
        return;
      }
      if (cur !== c.currency) {
        showError('–í–∞–ª—é—Ç–∞ –ø—Ä–æ–¥–∞–∂–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –≤–∞–ª—é—Ç–æ–π –∫—Ä—É–≥–∞.');
        return;
      }
      const qty = rub / price;
      if (qty > c.remainingQty + 1e-9) { // –º–∞–ª–µ–Ω—å–∫–∏–π –∑–∞–ø–∞—Å –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ float
        showError('–ü—Ä–µ–≤—ã—à–µ–Ω –æ—Å—Ç–∞—Ç–æ–∫ –≤–∞–ª—é—Ç—ã –≤ –∫—Ä—É–≥–µ.');
        return;
      }

      // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–¥–∞–∂—É
      c.sells.push({ qty, price, rub, note });
      c.remainingQty -= qty;
      c.sellQty += qty;
      c.sellRub += rub;

      // –ï—Å–ª–∏ –æ—Å—Ç–∞—Ç–æ–∫ <= 0, –∑–∞–∫—Ä—ã–≤–∞–µ–º –∫—Ä—É–≥
      if (c.remainingQty <= 1e-9) {
        c.closed = true;
        c.remainingQty = 0;
      }
      showError('');
    } else {
      showError('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Å–¥–µ–ª–∫–∏.');
      return;
    }

    // –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
    ['amount', 'currency', 'price', 'note'].forEach(id => $(id).value = '');
    render();
  };

  // --- –ö–Ω–æ–ø–∫–∏ +N –¥–ª—è —Å—É–º–º—ã ---
  document.querySelectorAll('[data-add]').forEach(btn => {
    btn.onclick = () => {
      const val = nf($('amount').value);
      const add = nf(btn.dataset.add);
      $('amount').value = (val + add).toFixed(2);
    };
  });

  // --- –≠–∫—Å–ø–æ—Ä—Ç CSV ---
  $('export').onclick = () => {
    if (circles.length === 0) {
      showError('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞.');
      return;
    }

    let csv = '–ö—Ä—É–≥ ID,–í–∞–ª—é—Ç–∞,–¢–∏–ø —Å–¥–µ–ª–∫–∏,–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ,–¶–µ–Ω–∞ (‚ÇΩ),–°—É–º–º–∞ (‚ÇΩ),–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ,–°—Ç–∞—Ç—É—Å –∫—Ä—É–≥–∞\n';

    circles.forEach(c => {
      // –ü–æ–∫—É–ø–∫–∞ –∫—Ä—É–≥–∞
      csv += `${c.id},${c.currency},–ü–æ–∫—É–ø–∫–∞,${fmt(c.buyQty)},${fmt(c.buyPrice)},${fmt(c.buyRub)},,${c.closed ? '–ó–∞–∫—Ä—ã—Ç' : '–û—Ç–∫—Ä—ã—Ç'}\n`;
      // –ü—Ä–æ–¥–∞–∂–∏
      c.sells.forEach(s => {
        csv += `${c.id},${c.currency},–ü—Ä–æ–¥–∞–∂–∞,${fmt(s.qty)},${fmt(s.price)},${fmt(s.rub)},${s.note || ''},${c.closed ? '–ó–∞–∫—Ä—ã—Ç' : '–û—Ç–∫—Ä—ã—Ç'}\n`;
      });
    });

    // –°–æ–∑–¥–∞—ë–º —Å—Å—ã–ª–∫—É –∏ –∫–ª–∏–∫–∞–µ–º –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'p2p_circles_export.csv';
    document.body.appendChild(a);
    a.click();
    setTimeout(() => {
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }, 100);
  };

  // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ---
  render();

})();
</script>
</body>
</html>
